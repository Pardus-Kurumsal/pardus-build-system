version: "2"
services:
  drone:
    container_name: droneci@@SUFFIX@@
    image: drone/drone:0.4
    ports:
      - "@@DRONE_PORT@@:8000"
    volumes:
      - @@DOCKER_VOLS@@/drone:/var/lib/drone
      - /var/run/docker.sock:/var/run/docker.sock
    env_file:
      - dronerc
    depends_on:
      - postgres
      - gogs
  gogs:
    image: gogs/gogs
    ports:
      - "@@GOGS_WEB_PORT@@:3000"
      - "@@GOGS_SSH_PORT@@:22"
    volumes:
      - @@DOCKER_VOLS@@/gogs:/data
    depends_on:
      - postgres
    container_name: gogs@@SUFFIX@@
  cgit:
    container_name: cgit@@SUFFIX@@
    image: sudhan/lighttpd-cgit
    volumes:
      - @@DOCKER_VOLS@@/gogs/git/gogs-repositories/pardus-debianized:/var/git
      - @@DOCKER_VOLS@@/etc/cgitrepos:/etc/cgitrepos
    ports:
      - "@@CGIT_PORT@@:80"
  postgres:
    container_name: postgres@@SUFFIX@@
    image: kiasaki/alpine-postgres
    volumes:
      - @@DOCKER_VOLS@@/postgres:/var/lib/postgresql/data
